<?php

use Ionos\Security\Controllers\WPScan;
printf('<h3>%s</h3>', \esc_html__('Vulnerability Block', 'ionos-essentials'));


global $wp_filter;
$controller = null;

// Check if the 'admin_init' hook exists in the global $wp_filter
if ( isset( $wp_filter['admin_init'] ) ) {
    // Loop through the hooks attached to 'admin_init'
    foreach ( $wp_filter['admin_init']->callbacks as $priority => $callbacks ) {
        foreach ( $callbacks as $callback ) {
            // Check if the callback is an object method
            if ( is_array( $callback['function'] ) && is_object( $callback['function'][0] ) ) {
                // The first element of the callback array is the object
                $object = $callback['function'][0];
                $method = $callback['function'][1];

                // Check if the method is 'check_scan_result'
                if ( $method === 'check_scan_result' ) {
                    $controller = $object;
                }
            }
        }
    }
}

if ( $controller ) {
  $controller->dashboad_widget_content();
} else {
  error_log( "No object found for 'check_scan_result' action." );
}
